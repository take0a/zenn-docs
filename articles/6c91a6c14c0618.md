---
title: "WindowsでMCPホスト"
emoji: "🧠"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["mcp", "claude", "gemini", "cursor", "githubcopilot"]
published: true
publication_name: "robon"
---

# はじめに
LLM の進歩は素晴らしいですね。2025/11/12 には、GPT-5.1、11/18 には Gemini 3.0、11/24 には、Claude Opus 4.5 が続けてリリースされました。この３つはそれぞれ得意、不得意もあるのでしょうが、ほぼ横一線というのが[結果](https://aws.amazon.com/jp/blogs/news/introducing-opus-45/)をみた感想です。

2025年は「AI エージェント元年」と呼ばれていて、自律的にタスクを計画・実行する「AI エージェント」の基盤技術として LLM が活用され、外部ツールや他の機能と連携することで、業務の自動化や最適化がさらに進んでいます。と Gemini が教えてくれました。

とはいえ、私の会社の Windows PC には、AI エージェントの気配が全くなく、そろそろヤバいかなということで、MCPホストとして使えるAIツールの皆さんにAIエージェントっぽいところを見せていただきましょうという記事です。

弊社の開発チームのみなさんが、データカタログ Mashu の MCP サーバーをリリースしたタイミングでもあり、そのテストと検証を兼ねてという裏事情もあります。 

# やってみた
## 比較対象
Gemini に相談して、以下をラインナップ。Claude Desktop 以外は開発ツール色が濃ゆい。
５種類とも全て無料でも使用できます（のでお試しください（Mashu もね））。

- Claude Desktop
- Gemini CLI
- VSCode
- Cursor
- Google Antigravity

「Microsoft Copilot は？」というお客様の声もお聞きしますが、ご本人の Microsoft Copilot さんに聞いてみたところ、「Copilot は、チャットベースのインターフェースで動作しており、外部の MCP サーバーやプロセスを直接起動・接続することはサポートしていません。」とのことなので、対象外ということで、エントリーしませんでした。

## インストール
今回の環境は、Surface Go 3 というどちらかというと非力な Windows PC で、`設定＞システム＞バージョン情報` に表示されている情報は、以下のとおり
- ストレージ： 119 GB
- グラフィックスカード： Intel UHD Graphics 615 128 MB
- 実装 RAM： 8.0 GB
- プロセッサ： Intel(R) Core(TM) i3-10100Y CPU @ 1.30GHz (1.61 GHz)

同じく、Windows の仕様は、以下のとおり
- エディション： Windows 11 Pro
- バージョン： 25H2

### Claude Desktop
Claude Desktop は、[こちらのページ](https://www.claude.com/ja-jp/download)からダウンロードできます。
インストーラ形式の `Claude Setup.exe` がダウンロードできますので、普通に入れてください。

### Gemini CLI
Gemini CLI は、[こちらのページ](https://github.com/google-gemini/gemini-cli)を見ながらインストールします。
前提条件として、Node.js のバージョン 20 以降が必要です。Node.js のインストールは、[こちらのページ](https://nodejs.org/ja/download)を参照してください。

最初のページのとおりですが、Node.js がインストールされている環境では、以下のようにインストールしてください。
```
npm install -g @google/gemini-cli
```

### VSCode
Visual Studio Code は、[こちらのページ](https://code.visualstudio.com/download)からダウンロードできます。
選択した種類のインストーラなどの資材をダウンロードしたら、インストールしてください。[ダウンロードした後に表示されるページ](https://code.visualstudio.com/docs/)にドキュメントもあります。

### Cursor
Cursor は、[こちらのページ](https://cursor.com/ja)（右上のボタン）からダウンロードできます。
インストーラ形式の `CursorSetup-x64-x.x.x.exe` がダウンロードできますので、普通に入れてください。ドキュメントは[こちら](https://docs.cursor.com/ja/get-started/installation)です。

### Google Antigravity
Google Antigravity は、[こちらのページ](https://antigravity.google/download) からダウンロードできます。
インストーラ形式の `Antigravity.exe` がダウンロードできますので、普通に入れてください。ドキュメントは[こちら](https://codelabs.developers.google.com/getting-started-google-antigravity?hl=ja#1)です。

## MCPサーバの設定
今回、使用する MCP サーバーは、弊社のデータカタログ SaaS の Mashu の MCP サーバーで、データカタログからベクトルとキーワードのハイブリッド検索を実行して、各 AI ツールが MCP ホストとなり、ユーザーからのリクエストがデータに関するものであれば、対象を絞り込むことができます。Mashu の MCP サーバーはローカルにインストールする標準入出力タイプです。

Mashu は、[こちらのページ](https://services.robon.co.jp/fabric/product/mashu/)から、また、MCP サーバー機能については、[こちらのページ](https://services.robon.co.jp/ja/kb/mashu/search-metadata-by-ai)に記載がありますが、お気軽に[お問い合わせ](https://services.robon.co.jp/fabric/contact)ください。

ここでは、ダウンロードした Mashu の MCP サーバーの保存先は、`C:\Demo\ai\mashu-mcp.exe` とします。

### Claude Desktop
Claude にサインインしたら、以下のメニューから `設定...` を選びます。
![](/images/6c91a6c14c0618/claude1.png)

`開発者` タブから `設定を編集` を選びます。
![](/images/6c91a6c14c0618/claude2.png)

エクスプローラーが `claude_desktop_config.json` を選択した状態になりますので、このファイルを以下のように編集します。`■` には、ご自分のものを設定します。

```json: claude_desktop_config.json
{
  "mcpServers": {
    "mashu-ai-search": {
      "command": "C:\\Demo\\ai\\mashu-mcp.exe",
      "args": [
        "-org-id",
        "■■■■-■■-■■-■■-■■■■",
        "-username",
        "■■■■",
        "-password",
        "■■■■"
      ]
    }
  }
}
```

### Gemini CLI
起動する前に、以下のような `settings.json` を用意します。場所は、Gemini CLI を動かすプロジェクトフォルダ直下の `.gemini/settings.json` または、ユーザーのホームディレクトリ直下の `.gemini/settings.json` になります。（Claude Desktop のものと同じ内容です。）

```json: .gemini/settings.json
{
  "mcpServers": {
    "mashu-ai-search": {
      "command": "C:\\Demo\\ai\\mashu-mcp.exe",
      "args": [
        "-org-id",
        "■■■■-■■-■■-■■-■■■■",
        "-username",
        "■■■■",
        "-password",
        "■■■■"
      ]
    }
  }
}
```

ターミナルで Gemini を起動します。Node.js のバージョンが新しいと `punycode` の[警告が出力](https://github.com/google-gemini/gemini-cli/issues/8405)されますが、無視しても大丈夫です。起動したら　`/mcp` コマンドで確認します。

![](/images/6c91a6c14c0618/gemini1.png)

このように `Ready` になれば OK です。

![](/images/6c91a6c14c0618/gemini2.png)

### VSCode
VSCode は、設定の中から探すこともできるようなのですが、Gemini CLI と同様、先に `mcp.json` ファイルを用意して設定できます。場所は、VSCode が開くワークスペースかフォルダ直下の `.vscode/mcp.json` または、ユーザーのホームディレクトリ直下の `.vscode/mcp.json` になります。書式は、[こちらのページ](https://code.visualstudio.com/docs/copilot/customization/mcp-servers#_configuration-format)を参照ください。

```json: .vscode/mcp.json
{
	"servers": {
		"mashu-ai-search": {
			"type": "stdio",
			"command": "C:\\Demo\\ai\\mashu-mcp.exe",
			"args": [
				"-org-id",
				"■■■■-■■-■■-■■-■■■■",
				"-username",
				"■■■■",
				"-password",
				"■■■■"
			]
		}
	},
	"inputs": []
}
```

この状態で VSCode を起動して、チャットの `ツールの構成...` ボタンを押した際に表示されていれば OK です。

![](/images/6c91a6c14c0618/vscode.png)

### Cursor
Cursor も設定の中から探せますが、結局、ファイルに書いてね！になるので、他のツールと同様に `mcp.json` ファイルを用意して設定します。場所も他のツールと同様、プロジェクトルートかホームディレクトリ直下の `.cursor/mcp.json` になります。

```json: .cursor/mcp.json
{
  "mcpServers": {
    "mashu-ai-search": {
      "command": "C:\\Demo\\ai\\mashu-mcp.exe",
      "args": [
        "-org-id",
        "■■■■-■■-■■-■■-■■■■",
        "-username",
        "■■■■",
        "-password",
        "■■■■"
      ]
    }
  }
}
```

この状態で Cursor を起動して、設定画面を開きます。

![](/images/6c91a6c14c0618/cursor1.png)

`Tools & MCP` タブで、`mashu-ai-search` を見つけて、`Off` を `On` にします。

![](/images/6c91a6c14c0618/cursor2.png)

### Google Antigravity
Antigravity もファイルを先に作ることもできますが、Antigravity に対象のファイルを作ってもらう流れでいきます。まず、Antigravity を起動して、`Agent` パネルの右上の `...` から `MCP Server` を選びます。

![](/images/6c91a6c14c0618/antig1.png)

`MCP Store` パネルの右上の `Manage MCP Servers` を押して、エディタパネルを `Manage MCP servers` にして、`View raw config` を押します。

![](/images/6c91a6c14c0618/antig2.png)

以下のように `mcp_config.json` の編集画面になります。

![](/images/6c91a6c14c0618/antig3.png)

ここに以下のように設定します。

```json: mcp_config.json
{
  "mcpServers": {
    "mashu-ai-search": {
      "command": "C:\\Demo\\ai\\mashu-mcp.exe",
      "args": [
        "-org-id",
        "■■■■-■■-■■-■■-■■■■",
        "-username",
        "■■■■",
        "-password",
        "■■■■"
      ],
      "env": {},
      "disabled": false
    }
  }
}
```

画面が戻ったら、`Refresh` します。

![](/images/6c91a6c14c0618/antig4.png)


## MCPサーバの実行
評価環境は、少し古い本ですが、「[業務知識と情報システム](https://www.amazon.co.jp/dp/4876014272)」という書籍に記載されている製造業をモデルに、ほぼ全ての業務を網羅しています。記載されているファイルとその項目の情報をできるだけ原典に忠実に（＝私の主観の入らないように） PostgreSQL 上のテーブルとして登録しました。テーブル数は 191 テーブルになりました。

原典で、これらのファイルから出力することになっている帳票を作るために何をすれば良いのか？を AI エージェントに考えてもらうというのがテストシナリオです。チャットの指示は、以下の流れで行いますが、AI エージェントが自分で次の指示まで行う場合は、暖かく見守ります。また、うまくできない場合は、指示を微修正しました。

1. 営業計画実績対比表を作成したいので、使えそうなテーブルを探してください
2. 営業会議の資料としたいので、各種マスターデータと結合したいです。必要となるマスターデータも探してください
3. SQLも作成してください。

紙芝居だとわかりにくいので、動画を掲載します。MCP サーバーの動作に許可が必要な場合は、リハーサル時点で許可したので、１度で良いものは許可を求めるステップが省略されています。

### Claude Desktop

Sonnet 4.5 なので、最新・最強ではありませんが、流石、Computer Use や MCP をはじめただけあって、かなり、スムーズに問題を解決できました。

https://youtu.be/CXMLzxeE0UA

### Gemini CLI

[Gemini CLI では、Gemini 3.0 も使える](https://developers.googleblog.com/ja/5-things-to-try-with-gemini-3-pro-in-gemini-cli/)のですが、無料ユーザーは待機列に並ばないといけなかったので、今回は、Gemini 2.5 です。

設定があるのかもしれませんが、セッション毎に MCP サーバーの使用許可を求められます。また、Mashu の AI 検索では検索条件にヒットしたもののうち何件を返すか？を Limit で指定できるのですが、Gemini CLI は、Limit=1 にして、たくさん来ないようにしてるのか、俺の期待しているものを返せという感じの探し方が特徴的でした。その分、検索回数と検索時間が他のものより多くなりました。

https://youtu.be/xeUvKLZv1r8

### VSCode

VSCode の場合は、Github Copilot を使うため、Github の認証を求められます。

設定のところでもご覧いただいたように、他のツールも設定されていて、すぐにインターネットに出かけようとするので、「Mashu で」というキーワードを投入しました。それでも違うツールを使おうとする場合もありました。

https://youtu.be/B-k_vWXvDR4

### Cursor

Cursor は、無料ユーザーの場合は、使えるモデルが限られているので、`Auto` を選択しました。

Github Copilot とは異なり、流石、開発ツールというべきか、プロジェクトフォルダー中のファイルを探したくて仕方ない感じなので、こちらも「Mashu で」というキーワードを投入しています。また、検索結果としてデフォルトの５件が返ってくると、不要なものを排除せず、できるだけ活かそうとしているように見えました。その分、最終結果がぼやけてしまうので、SQL は要求しませんでした。

https://youtu.be/yCy0BdCqjic

### Google Antigravity

こちらは、太っ腹に Gemini 3.0 Pro です。

Antigravity は、LLM が考えた軌跡をファイルに残してくれるので、かなり実用的というか実践的なツールになっています。
また、Gemini 3.0 Pro だからかもしれませんが、よく考えていて、特に、従業員マスタとして、どのテーブルを使うべきか、考えられる様々な名前で何度も検索をして見落としの無いようにしているのが印象的でした。

https://youtu.be/ucWUB5BK0Wg

# おわりに
なかなか素晴らしい結果でした。しかも 2025年は「AI エージェント元年」ということなので、来年以降も LLM の推論が早く、深くなればなるほど優秀なエージェントになることは確実なので、すぐにでも実業務に導入すべきタイミングと言えるでしょう。

プログラマー以外の人の業務にも AI エージェントが浸透していくには、ツールも変わっていく必要もあるのかもしれませんが、2018年ごろに DX というワードが使われ始め、全てのホワイトカラーの仕事はデジタルとデータを活用する業務に代わると言われていた頃、ホンマかいな？と思っていましたが、こういうツールを使うのが当たり前という姿になっていくとすれば、そのとおりだなと思います。
