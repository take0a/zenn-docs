---
title: "NestJSã§RESTï¼ˆãã®ï¼‘ï¼‰"
emoji: "ğŸ¦"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["nestjs", "rest", "postgresql", "nodejs", "typescript"]
published: true
publication_name: "robon"
---

# ã¯ã˜ã‚ã«
å½“ç¤¾ã§ã¯ã€ã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ãªSaaSã®é–‹ç™ºã‚’ã—ã¦ãŠã‚Šã€ã„ã¤ã‚‚ã¯WebAPIã®å®Ÿè£…ãªã‚‰ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã§ã€‚ã¨ãªã‚‹ã®ã§ã™ãŒã€ä»Šå›ã¯ã€ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã§ãªã„WebAPIã®å®Ÿç¾æ–¹æ³•ã¨ã—ã¦ã€NestJSã‚’å‹•ã‹ã—ã¦ã¿ã¾ã—ãŸã¨ã„ã†å†…å®¹ã§ã™ã€‚

## ã‚„ã‚ŠãŸã„ã“ã¨
ã“ã‚“ãªæ„Ÿã˜ã®ã‚ˆãã‚ã‚Šãã†ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’
```mermaid
erDiagram
    CUSTOMER ||..o{ ORDER_HEADER : "æ³¨æ–‡ã™ã‚‹"
    CUSTOMER {
        int CUSTOMER_ID PK "é¡§å®¢ID"
        text NAME "æ°å"
        text ADDRESS "ä½æ‰€"
    }
    ORDER_HEADER ||--|{ ORDER_DETAIL : "æ§‹æˆã™ã‚‹"
    ORDER_HEADER {
        int ORDER_ID PK "å—æ³¨ID"
        int CUSTOMER_ID FK "é¡§å®¢ID"
        date ORDER_DATE "å—æ³¨æ—¥"
    }
    ORDER_DETAIL {
        int ORDER_ID PK "å—æ³¨ID"
        int ROW_NUMBER PK "è¡Œç•ªå·"
        int PRODUCT_ID FK "è£½å“ID"
        int QUANTITY "æ•°é‡"
        int PRICE_PER_UNIT "è²©å£²å˜ä¾¡"
    }
    ORDER_DETAIL }o..|| PRODUCT : "è²©å£²ã™ã‚‹"
    PRODUCT {
        int PRODUCT_ID PK "è£½å“ID"
        text NAME "è£½å“å"
        int PRICE_PER_UNIT "æ¨™æº–å˜ä¾¡"
    }
```

ã“ã‚“ãªæ„Ÿã˜ã®RESTãƒªã‚½ãƒ¼ã‚¹ã¨ã—ã¦å…¬é–‹ã—ãŸã„ã€‚ã¨ã—ã¾ã™ã€‚
```mermaid
erDiagram
    customer {
        int customerId PK "é¡§å®¢ID"
        string name "æ°å"
        string address "ä½æ‰€"
    }
    order ||--|{ orderDetail : "details"
    order {
        int orderId PK "å—æ³¨ID"
        int customerId FK "é¡§å®¢ID"
        date orderDate "å—æ³¨æ—¥"
    }
    orderDetail {
        int rowNumber PK "è¡Œç•ªå·"
        int productID "è£½å“ID"
        int quantity "æ•°é‡"
        int pricePerUnit "è²©å£²å˜ä¾¡"
    }
    product {
        int productId PK "è£½å“ID"
        string name "è£½å“å"
        int pricePerUnit "æ¨™æº–å˜ä¾¡"
    }
```

# ã‚„ã£ãŸã“ã¨
## NestJSã®å°å…¥
```bash
$ node --version
v16.19.1
$ npm --version
8.19.2
$ npm i -g @nestjs/cli
$ nest --version
9.3.0
$ nest new nestjs-sample
? Which package manager would you â¤ï¸  to use? npm
ğŸš€  Successfully created project nestjs-sample
```
åˆ¥ä»¶ã§ä½¿ç”¨ä¸­ã®ç’°å¢ƒã§ã™ãŒã€ãªã‚“ã®å•é¡Œã‚‚ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚

### ç¢ºèª
```bash
$ npm run start
```
ã§èµ·å‹•ã—ã¦ã€åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‹ã‚‰

```bash
$ curl http://localhost:3000/
Hello World!
```
ãŠãŠã€ä½•ã‚‚ã—ã¦ãªã„ã‘ã©å‹•ãã€‚ç´ æ•µã§ã™ã€‚

## CRUD generator
ã©ã‚“ãªæ„Ÿã˜ã§æ§‹æˆã™ã‚‹ã®ãŒè‰¯ã„ã®ã‹ã—ã‚‰ã¨æœ¬å®¶ã®ã‚µã‚¤ãƒˆã‚’è¦‹ã¦ã„ã‚‹ã¨ã‚ã‚Šã¾ã—ãŸã€‚

https://docs.nestjs.com/recipes/crud-generator

ã‚„ã£ã¦ã¿ã¾ã™ã€‚
```bash
$ nest g resource customers
? What transport layer do you use? REST API
? Would you like to generate CRUD entry points? Yes
âœ” Packages installed successfully.
```

### ç¢ºèª
ã“ã‚“ãªæ„Ÿã˜ã§ customers ä»¥ä¸‹ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¦ã€app.module ã«è¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚
```bash
$ tree src
src
â”œâ”€â”€ app.controller.spec.ts
â”œâ”€â”€ app.controller.ts
â”œâ”€â”€ app.module.ts
â”œâ”€â”€ app.service.ts
â”œâ”€â”€ customers
â”‚   â”œâ”€â”€ customers.controller.spec.ts
â”‚   â”œâ”€â”€ customers.controller.ts
â”‚   â”œâ”€â”€ customers.module.ts
â”‚   â”œâ”€â”€ customers.service.spec.ts
â”‚   â”œâ”€â”€ customers.service.ts
â”‚   â”œâ”€â”€ dto
â”‚   â”‚   â”œâ”€â”€ create-customer.dto.ts
â”‚   â”‚   â””â”€â”€ update-customer.dto.ts
â”‚   â””â”€â”€ entities
â”‚       â””â”€â”€ customer.entity.ts
â””â”€â”€ main.ts
```

```bash
$ npm run start
```
ã§èµ·å‹•ã—ã¦ã€ã¾ãŸã€åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‹ã‚‰

```bash
$ curl http://localhost:3000/customers
This action returns all customers
```
ã¾ã ã€ãªã«ã‚‚ã—ã¦ã„ãªã„ã‘ã©ã€ã¡ã‚ƒã‚“ã¨ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã€‚ğŸ‘

# æ¬¡å›ã¯

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œã£ã¦ç¹‹ãã¾ã™ã€‚

https://zenn.dev/robon/articles/32bf49163826ca
