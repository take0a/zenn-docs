---
title: "dltã®ä»•çµ„ã¿"
emoji: "ğŸ”—"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["python", "dlt", "uv", "duckdb"]
published: false
publication_name: "robon"
---

# ã¯ã˜ã‚ã«
ä½•ã‹æœˆã‹å‰ã«ã€[dltå…¥é–€](https://zenn.dev/robon/articles/b82a94295e8fae) ã¨é¡Œã—ã¦ã€dlt ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’ãªãã‚‹ã‚ˆã†ãªè¨˜äº‹ã‚’æ›¸ãã¾ã—ãŸã€‚
dlt ãŒã€ELT ã® E ã¨ L ã‚’ã‚„ã£ã¦ãã‚Œã‚‹ã®ã¯ã€ã‚ã‹ã£ãŸã®ã§ã™ãŒã€ã‚ã¾ã‚Šã«ã‚‚å°‘ãªã„è¡Œæ•°ã§ã‚³ãƒ”ãƒ¼ã§ãã¦ã—ã¾ã£ãŸã®ã§ã€Œã§ã€ã©ã†ãªã£ã¦ã‚‹ã®ï¼Ÿã€ã‚’èª¿ã¹ã¦ã¿ã‚ˆã†ã¨ã„ã†è¨˜äº‹ã§ã™ã€‚

# ã‚„ã£ã¦ã¿ã‚‹
## å¾©ç¿’
ã¾ãšã¯ã€å‰å›ã®å¾©ç¿’ã‹ã‚‰ã€‚ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã®ã¨ãŠã‚Šã«ã‚„ã‚‹ã¨ã€CLI ãŒ init ã§ãƒ¢ãƒªãƒ¢ãƒªæ›¸ã„ã¦ãã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚‚ã‚ã‚‹ã®ã§ã€ãƒãƒƒã‚µãƒªå‰Šé™¤ã—ã¦ã¿ã¾ã™ã€‚

### REST API
ä»¥ä¸‹ã®ã¨ãŠã‚Šã€30è¡Œã¡ã‚‡ã„ã§ã™ã€‚

```py: rest-api/rest_api_pipeline.py
import dlt
from dlt.sources.rest_api import rest_api_source


pokemon_source = rest_api_source(
    {
        "client": {
            "base_url": "https://pokeapi.co/api/v2/",
        },
        "resource_defaults": {
            "endpoint": {
                "params": {
                    "limit": 1000,
                },
            },
        },
        "resources": [
            "pokemon",
            "berry",
            "location",
        ],
    }
)

pipeline = dlt.pipeline(
    pipeline_name="rest_api_pokemon",
    destination="duckdb",
    dataset_name="rest_api_data",
)

load_info = pipeline.run(pokemon_source)
print(load_info)
```

### SQL DB
ã“ã£ã¡ã¯ã€10è¡Œã¡ã‚‡ã„ã§ã™ã€‚

```py: sql-database/sql_database_pipeline.py
import dlt
from dlt.sources.sql_database import sql_database


source = sql_database().with_resources("family", "genome")

pipeline = dlt.pipeline(
    pipeline_name="sql_to_duckdb_pipeline",
    destination="duckdb",
    dataset_name="sql_to_duckdb_pipeline_data",
)

load_info = pipeline.run(source)
print(load_info)
```

ã‚ã¨ã€DB ã¸ã®æ¥ç¶šæƒ…å ±ãŒå¿…è¦ã§ã™ã€‚

```toml: sql-database/.dlt/secret.toml
[sources.sql_database.credentials]
drivername = "mysql+pymysql" # database+dialect
database = "Rfam"
password = ""
username = "rfamro"
host = "mysql-rfam-public.ebi.ac.uk"
port = 4497
```

### File System
ã“ã‚Œã‚‚ 10è¡Œã¡ã‚‡ã„ã€‚

```py: file-system/filesystem_pipeline.py
import dlt
from dlt.sources.filesystem import filesystem, read_csv


files = filesystem(bucket_url="gs://filesystem-tutorial", file_glob="encounters*.csv")
reader = (files | read_csv()).with_name("encounters")

pipeline = dlt.pipeline(
    pipeline_name="hospital_data_pipeline",
    destination="duckdb",
    dataset_name="hospital_data",
)

info = pipeline.run(reader)
print(info)
```

è¨­å®šæƒ…å ±ã¯ã€ä»¥ä¸‹ã®ï¼’ã¤

```toml: file-system/.dlt/config.toml
[sources.readers.filesystem]
bucket_url="gs://filesystem-tutorial"
```
```toml: file-system/.dlt/secret.toml
[sources.readers.filesystem.credentials]
client_email = "public-access@dlthub-sandbox.iam.gserviceaccount.com"
project_id = "dlthub-sandbox"
private_key = "-----BEGIN PRIVATE KEY-----\nMIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQDGWsVHJRjliojx\nTo+j1qu+x8PzC5ZHZrMx6e8OD6tO8uxMyl65ByW/4FZkVXkS4SF/UYPigGN+rel4\nFmySTbP9orva4t3Pk1B9YSvQMB7V5IktmTIW9Wmdmn5Al8Owb1RehgIidm1EX/Z9\nLr09oLpO6+jUu9RIP2Lf2mVQ6tvkgl7UOdpdGACSNGzRiZgVZDOaDIgH0Tl4UWmK\n6iPxhwZy9YC2B1beLB/NU+F6DUykrEpBzCFQTqFoTUcuDAEvuvpU9JrU2iBMiOGw\nuP3TYSiudhBjmauEUWaMiqWAgFeX5ft1vc7/QWLdI//SAjaiTAu6pTer29Q0b6/5\niGh0jRXpAgMBAAECggEAL8G9C9MXunRvYkH6/YR7F1T7jbH1fb1xWYwsXWNSaJC+\nagKzabMZ2KfHxSJ7IxuHOCNFMKyex+pRcvNbMqJ4upGKzzmeFBMw5u8VYGulkPQU\nPyFKWRK/Wg3PZffkSr+TPargKrH+vt6n9x3gvEzNbqEIDugmRTrVsHXhvOi/BrYc\nWhppHSVQidWZi5KVwDEPJjDQiHEcYI/vfIy1WhZ8VuPAaE5nMZ1m7gTdeaWWKIAj\n/p2ZkLgRdCY8vNkfaNDAxDbvH+CMuTtOw55GydzsYYiofANS6xZ8CedGkYaGi82f\nqGdLghX61Sg3UAb5SI36T/9XbuCpTf3B/SMV20ew8QKBgQDm2yUxL71UqI/xK9LS\nHWnqfHpKmHZ+U9yLvp3v79tM8XueSRKBTJJ4H+UvVQrXlypT7cUEE+sGpTrCcDGL\nm8irtdUmMvdi7AnRBgmWdYKig/kgajLOUrjXqFt/BcFgqMyTfzqPt3xdp6F3rSEK\nHE6PQ8I3pJ0BJOSJRa6Iw2VH1QKBgQDb9WbVFjYwTIKJOV4J2plTK581H8PI9FSt\nUASXcoMTixybegk8beGdwfm2TkyF/UMzCvHfuaUhf+S0GS5Zk31Wkmh1YbmFU4Q9\nm9K/3eoaqF7CohpigB0wJw4HfqNh6Qt+nICOMCv++gw7+/UwfV72dCqr0lpzfX5F\nAsez8igTxQKBgDsq/axOnQr+rO3WGpGJwmS8BKfrzarxGXyjnV0qr51X4yQdfGWx\nV3T8T8RC2qWI8+tQ7IbwB/PLE3VURg6PHe6MixXgSDGNZ7KwBnMOqS23/3kEXwMs\nhn2Xg+PZeMeqW8yN9ldxYqmqViMTN32c5bGoXzXdtfPeHcjlGCerVOEFAoGADVPi\nRjkRUX3hTvVF6Gzxa2OyQuLI1y1O0C2QCakrngyI0Dblxl6WFBwDyHMYGepNnxMj\nsr2p7sy0C+GWuGDCcHNwluQz/Ish8SW28F8+5xyamUp/NMa0fg1vwS6AMdeQFbzf\n4T2z/MAj66KJqcV+8on5Z+3YAzVwaDgR56pdmU0CgYBo2KWcNWAhZ1Qa6sNrITLV\nGlxg6tWP3OredZrmKb1kj5Tk0V+EwVN+HnKzMalv6yyyK7SWq1Z6rvCye37vy27q\nD7xfuz0c0H+48uWJpdLcsxpTioopsRPayiVDKlHSe/Qa+MEjAG3ded5TJiC+5iSw\nxWJ51y0wpme0LWgzzoLbRw==\n-----END PRIVATE KEY-----\n"
```

è¦ã™ã‚‹ã«ã€pipeline.run ã« dlt ç”¨èªã§è¨€ã†ã¨ã“ã‚ã® [Source](https://dlthub.com/docs/devel/general-usage/source) ã‚’æ¸¡ã—ã¦ãŠã—ã¾ã„ã€‚
ã¾ãã€é»’é­”è¡“çš„ãªä½•ã‹ã§ã™ï¼ˆç¬‘

## ã©ã†ãªã£ã¦ã‚‹ã®ï¼Ÿ

[ä¸Šè¨˜ã® REST API](#rest-api) ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®æœ€çµ‚è¡Œ `print(load_info)` ã«ã‚ˆã£ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

```sh
$ uv run rest_api_pipeline.py 
2025-07-08 02:20:03,926|[WARNING]|13043|139762141091648|dlt|client.py|detect_paginator:312|Fallback paginator used: SinglePagePaginator at 7f1cbfca83b0. Please provide right paginator manually.
Pipeline rest_api_pokemon load step completed in 0.19 seconds
1 load package(s) were loaded to destination duckdb and into dataset rest_api_data
The duckdb destination used duckdb:////home/ec2-user/work/mds/dlt-getting-started/rest-api/rest_api_pokemon.duckdb location to store data
Load package 1751941203.521931 is LOADED and contains no failed jobs
```

[Destination](https://dlthub.com/docs/devel/general-usage/destination) ã® `rest_api_pokemon.duckdb` ã‚’èª¿ã¹ã¦ã¿ã¾ã™ã€‚

```sh
$ ~/.duckdb/cli/latest/duckdb rest_api_pokemon.duckdb
v1.2.1 8e52ec4395
Enter ".help" for usage hints.
D .tables
_dlt_loads           _dlt_version         location           
_dlt_pipeline_state  berry                pokemon            
D .schema pokemon
CREATE TABLE rest_api_data.pokemon("name" VARCHAR, url VARCHAR, _dlt_load_id VARCHAR NOT NULL, _dlt_id VARCHAR NOT NULL);
D .maxrows 10
D select * from rest_api_data.pokemon;
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           name           â”‚                   url                    â”‚   _dlt_load_id    â”‚    _dlt_id     â”‚
â”‚         varchar          â”‚                 varchar                  â”‚      varchar      â”‚    varchar     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ bulbasaur                â”‚ https://pokeapi.co/api/v2/pokemon/1/     â”‚ 1751941203.521931 â”‚ rRaJzqYDYOQKzw â”‚
â”‚ ivysaur                  â”‚ https://pokeapi.co/api/v2/pokemon/2/     â”‚ 1751941203.521931 â”‚ f+4TykRTqpvGow â”‚
â”‚ venusaur                 â”‚ https://pokeapi.co/api/v2/pokemon/3/     â”‚ 1751941203.521931 â”‚ jLaaVsbYDZ2RKg â”‚
â”‚ charmander               â”‚ https://pokeapi.co/api/v2/pokemon/4/     â”‚ 1751941203.521931 â”‚ l63T6AFiyzV1Mw â”‚
â”‚ charmeleon               â”‚ https://pokeapi.co/api/v2/pokemon/5/     â”‚ 1751941203.521931 â”‚ H6cElA2854FO/A â”‚
â”‚     Â·                    â”‚                  Â·                       â”‚         Â·         â”‚       Â·        â”‚
â”‚     Â·                    â”‚                  Â·                       â”‚         Â·         â”‚       Â·        â”‚
â”‚     Â·                    â”‚                  Â·                       â”‚         Â·         â”‚       Â·        â”‚
â”‚ ogerpon-wellspring-mask  â”‚ https://pokeapi.co/api/v2/pokemon/10273/ â”‚ 1751941203.521931 â”‚ 3ngMzqxa7i1/vA â”‚
â”‚ ogerpon-hearthflame-mask â”‚ https://pokeapi.co/api/v2/pokemon/10274/ â”‚ 1751941203.521931 â”‚ wEsxg2ZxkTOgHg â”‚
â”‚ ogerpon-cornerstone-mask â”‚ https://pokeapi.co/api/v2/pokemon/10275/ â”‚ 1751941203.521931 â”‚ GAB25+W8YF47cg â”‚
â”‚ terapagos-terastal       â”‚ https://pokeapi.co/api/v2/pokemon/10276/ â”‚ 1751941203.521931 â”‚ 9Eu4tjzcesxQCQ â”‚
â”‚ terapagos-stellar        â”‚ https://pokeapi.co/api/v2/pokemon/10277/ â”‚ 1751941203.521931 â”‚ v/g6/OOE1W5xLg â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1302 rows (10 shown)                                                                           4 columns â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
D .quit
```

### Pipeline ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

ã‚„ã£ã±ã‚Šã€ã‚ˆãã‚ã‹ã‚Šã¾ã›ã‚“ã€‚åˆ¥ã«éš ã—ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ã®ã§ã—ã‚‡ã†ãŒã€[Pipeline working directory](https://dlthub.com/docs/general-usage/pipeline#pipeline-working-directory) ã¨ã„ã†ã®ãŒã‚ã£ã¦ã€ã“ã‚Œã¨ã‚»ãƒƒãƒˆã§è€ƒãˆãªã„ã¨ã€ã‚¹ã‚­ãƒ¼ãƒã®æ¨å®šã ã£ãŸã‚Šã€é€²åŒ–ã ã£ãŸã‚Šã§ãã¡ã‚ƒã†ã®ã¯ã€æ„å‘³ãŒã‚ã‹ã‚‰ãªã„ã§ã™ã€‚

ã¨ã„ã†ã“ã¨ã§ã€è¦‹ã¦ã¿ã¾ã™ã€‚

```sh
$ tree -a ~/.dlt
/home/ec2-user/.dlt
â”œâ”€â”€ .anonymous_id
â””â”€â”€ pipelines
    â””â”€â”€ rest_api_pokemon
        â”œâ”€â”€ load
        â”‚   â”œâ”€â”€ .version
        â”‚   â”œâ”€â”€ loaded
        â”‚   â”‚   â””â”€â”€ 1751941203.521931
        â”‚   â”‚       â”œâ”€â”€ applied_schema_updates.json
        â”‚   â”‚       â”œâ”€â”€ completed_jobs
        â”‚   â”‚       â”‚   â”œâ”€â”€ _dlt_pipeline_state.01049b38d0.0.insert_values
        â”‚   â”‚       â”‚   â”œâ”€â”€ berry.fcc100835e.0.insert_values
        â”‚   â”‚       â”‚   â”œâ”€â”€ location.c617abb58e.0.insert_values
        â”‚   â”‚       â”‚   â””â”€â”€ pokemon.4c44034d94.0.insert_values
        â”‚   â”‚       â”œâ”€â”€ failed_jobs
        â”‚   â”‚       â”œâ”€â”€ load_package_state.json
        â”‚   â”‚       â”œâ”€â”€ new_jobs
        â”‚   â”‚       â”œâ”€â”€ package_completed.json
        â”‚   â”‚       â”œâ”€â”€ schema.json
        â”‚   â”‚       â””â”€â”€ started_jobs
        â”‚   â”œâ”€â”€ new
        â”‚   â””â”€â”€ normalized
        â”œâ”€â”€ normalize
        â”‚   â”œâ”€â”€ .version
        â”‚   â””â”€â”€ extracted
        â”œâ”€â”€ schemas
        â”‚   â””â”€â”€ rest_api.schema.json
        â”œâ”€â”€ state.json
        â””â”€â”€ trace.pickle

14 directories, 14 files
```

ã¾ã€ç›´æ„Ÿçš„ã« `normalize/extracted` -> `load/normalized` -> `load/loaded` ãªã‚“ã§ã—ã‚‡ã†ã­ã€‚

èª­ã‚ãã†ãªãƒ¤ãƒ„ã‹ã‚‰ã€è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ä»¥ä¸‹ã€`~/.dlt/pipeline/rest_api_pokemon/` é…ä¸‹ã§ã™ã€‚ã‚ã¨ã€äººé–“ç”¨ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ã¦ã‚ã‚Šã¾ã™ã€‚

```json: state.json
{
    "_state_version": 1,
    "_state_engine_version": 4,
    "_local": {
        "first_run": false,
        "initial_cwd": "/home/ec2-user/work/mds/dlt-getting-started/rest-api",
        "_last_extracted_at": "ï€§2025-07-08T02:20:05.457912+00:00",
        "_last_extracted_hash": "+wss72MdiSWsH7g47UzNMXD/ImQwLpGyJGjr/Honm0k="
    },
    "default_schema_name": "rest_api",
    "pipeline_name": "rest_api_pokemon",
    "dataset_name": "rest_api_data",
    "schema_names": [
        "rest_api"
    ],
    "destination_type": "dlt.destinations.duckdb",
    "destination_name": null,
    "_version_hash": "+wss72MdiSWsH7g47UzNMXD/ImQwLpGyJGjr/Honm0k="
}
```

å‰å›å®Ÿè¡Œæ™‚ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€åå‰ã€ãƒ‘ã‚¹ã€æ™‚åˆ»ãªã©ãŒã‚ã‚Šã¾ã™ã®ã§ã€ä»Šå›å¤‰ã‚ã£ãŸéƒ¨åˆ†ã¯åˆ¤å®šã§ããã†ã§ã™ã€‚

```json: schemas/rest_api.schema.json
{
  "version": 2,
  "version_hash": "bjSDsQVwCCxpVbi/s/7nk6E1Ezg9g65MV87tUMMvA8k=",
  "engine_version": 11,
  "name": "rest_api",
  "tables": {
    "_dlt_version": {
      "name": "_dlt_version",
      "columns": {
        "version": {
          "name": "version",
          "data_type": "bigint",
          "nullable": false
        },
        "engine_version": {
          "name": "engine_version",
          "data_type": "bigint",
          "nullable": false
        },
        "inserted_at": {
          "name": "inserted_at",
          "data_type": "timestamp",
          "nullable": false
        },
        "schema_name": {
          "name": "schema_name",
          "data_type": "text",
          "nullable": false
        },
        "version_hash": {
          "name": "version_hash",
          "data_type": "text",
          "nullable": false
        },
        "schema": {
          "name": "schema",
          "data_type": "text",
          "nullable": false
        }
      },
      "write_disposition": "skip",
      "resource": "_dlt_version",
      "description": "Created by DLT. Tracks schema updates"
    },
    "_dlt_loads": {
      "name": "_dlt_loads",
      "columns": {
        "load_id": {
          "name": "load_id",
          "data_type": "text",
          "nullable": false
        },
        "schema_name": {
          "name": "schema_name",
          "data_type": "text",
          "nullable": true
        },
        "status": {
          "name": "status",
          "data_type": "bigint",
          "nullable": false
        },
        "inserted_at": {
          "name": "inserted_at",
          "data_type": "timestamp",
          "nullable": false
        },
        "schema_version_hash": {
          "name": "schema_version_hash",
          "data_type": "text",
          "nullable": true
        }
      },
      "write_disposition": "skip",
      "resource": "_dlt_loads",
      "description": "Created by DLT. Tracks completed loads"
    },
    "pokemon": {
      "columns": {
        "name": {
          "name": "name",
          "data_type": "text",
          "nullable": true
        },
        "url": {
          "name": "url",
          "data_type": "text",
          "nullable": true
        },
        "_dlt_load_id": {
          "name": "_dlt_load_id",
          "data_type": "text",
          "nullable": false
        },
        "_dlt_id": {
          "name": "_dlt_id",
          "data_type": "text",
          "nullable": false,
          "unique": true,
          "row_key": true
        }
      },
      "write_disposition": "append",
      "name": "pokemon",
      "resource": "pokemon",
      "x-normalizer": {
        "seen-data": true
      }
    },
    "berry": {
      "columns": {
        "name": {
          "name": "name",
          "data_type": "text",
          "nullable": true
        },
        "url": {
          "name": "url",
          "data_type": "text",
          "nullable": true
        },
        "_dlt_load_id": {
          "name": "_dlt_load_id",
          "data_type": "text",
          "nullable": false
        },
        "_dlt_id": {
          "name": "_dlt_id",
          "data_type": "text",
          "nullable": false,
          "unique": true,
          "row_key": true
        }
      },
      "write_disposition": "append",
      "name": "berry",
      "resource": "berry",
      "x-normalizer": {
        "seen-data": true
      }
    },
    "location": {
      "columns": {
        "name": {
          "name": "name",
          "data_type": "text",
          "nullable": true
        },
        "url": {
          "name": "url",
          "data_type": "text",
          "nullable": true
        },
        "_dlt_load_id": {
          "name": "_dlt_load_id",
          "data_type": "text",
          "nullable": false
        },
        "_dlt_id": {
          "name": "_dlt_id",
          "data_type": "text",
          "nullable": false,
          "unique": true,
          "row_key": true
        }
      },
      "write_disposition": "append",
      "name": "location",
      "resource": "location",
      "x-normalizer": {
        "seen-data": true
      }
    },
    "_dlt_pipeline_state": {
      "columns": {
        "version": {
          "name": "version",
          "data_type": "bigint",
          "nullable": false
        },
        "engine_version": {
          "name": "engine_version",
          "data_type": "bigint",
          "nullable": false
        },
        "pipeline_name": {
          "name": "pipeline_name",
          "data_type": "text",
          "nullable": false
        },
        "state": {
          "name": "state",
          "data_type": "text",
          "nullable": false
        },
        "created_at": {
          "name": "created_at",
          "data_type": "timestamp",
          "nullable": false
        },
        "version_hash": {
          "name": "version_hash",
          "data_type": "text",
          "nullable": true
        },
        "_dlt_load_id": {
          "name": "_dlt_load_id",
          "data_type": "text",
          "nullable": false
        },
        "_dlt_id": {
          "name": "_dlt_id",
          "data_type": "text",
          "nullable": false,
          "unique": true,
          "row_key": true
        }
      },
      "write_disposition": "append",
      "file_format": "preferred",
      "name": "_dlt_pipeline_state",
      "resource": "_dlt_pipeline_state",
      "x-normalizer": {
        "seen-data": true
      }
    }
  },
  "settings": {
    "detections": [
      "iso_timestamp"
    ],
    "default_hints": {
      "not_null": [
        "_dlt_id",
        "_dlt_root_id",
        "_dlt_parent_id",
        "_dlt_list_idx",
        "_dlt_load_id"
      ],
      "parent_key": [
        "_dlt_parent_id"
      ],
      "root_key": [
        "_dlt_root_id"
      ],
      "unique": [
        "_dlt_id"
      ],
      "row_key": [
        "_dlt_id"
      ]
    }
  },
  "normalizers": {
    "names": "snake_case",
    "json": {
      "module": "dlt.common.normalizers.json.relational"
    }
  },
  "previous_hashes": [
    "Gdc4n1qRXwTiCnCfqycCWAxxyGDgn7jbj2mCE7FJefs=",
    "um3SJOIZvj59vzg3myb1oaPOCmc8F4VMRHh2hVBN694="
  ]
}
```

ã“ã‚Œã‚‰ã¯ã€é€ä¿¡å…ˆã® DuckDB ã«å¯¾å¿œã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚ï¼ˆã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€äººé–“ç”¨ãªã®ã‹ã€ä¸Šè¨˜ã®ã¨ãŠã‚Šãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚Œã¦ã„ã¾ã™ï¼‰

`pokemon`ã€`berry`ã€`location` ã®ï¼“ã¤ãŒ [Resource](https://dlthub.com/docs/general-usage/resource) æŒ‡å®šã—ãŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã€`_dlt_version`ã€`_dlt_loads`ã€`_dlt_pipeline_state` ã®ï¼“ã¤ãŒ dlt ã®åˆ¶å¾¡ç”¨ã®ã‚ˆã†ã§ã™ã€‚

åˆ¶å¾¡ç”¨ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¸­èº«ã‚‚è¦—ã„ã¦ã¿ã¾ã™ã€‚hash å€¤ã§ã€ãã®å›ã®çŠ¶æ…‹ã‚’ä¿æŒã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

```
D select * from rest_api_data._dlt_version;
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ version â”‚ engine_version â”‚     inserted_at      â”‚ schema_name â”‚     version_hash     â”‚                    schema                    â”‚
â”‚  int64  â”‚     int64      â”‚ timestamp with timâ€¦  â”‚   varchar   â”‚       varchar        â”‚                   varchar                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    2    â”‚       11       â”‚ 2025-07-08 02:20:0â€¦  â”‚ rest_api    â”‚ bjSDsQVwCCxpVbi/s/â€¦  â”‚ {"version":2,"version_hash":"bjSDsQVwCCxpVâ€¦  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
D select * from rest_api_data._dlt_loads;
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      load_id      â”‚ schema_name â”‚ status â”‚          inserted_at          â”‚             schema_version_hash              â”‚
â”‚      varchar      â”‚   varchar   â”‚ int64  â”‚   timestamp with time zone    â”‚                   varchar                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1751941203.521931 â”‚ rest_api    â”‚   0    â”‚ 2025-07-08 02:20:05.711779+00 â”‚ bjSDsQVwCCxpVbi/s/7nk6E1Ezg9g65MV87tUMMvA8k= â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
D select * from rest_api_data._dlt_version;
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ version â”‚ engine_version â”‚     inserted_at      â”‚ schema_name â”‚     version_hash     â”‚                    schema                    â”‚
â”‚  int64  â”‚     int64      â”‚ timestamp with timâ€¦  â”‚   varchar   â”‚       varchar        â”‚                   varchar                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    2    â”‚       11       â”‚ 2025-07-08 02:20:0â€¦  â”‚ rest_api    â”‚ bjSDsQVwCCxpVbi/s/â€¦  â”‚ {"version":2,"version_hash":"bjSDsQVwCCxpVâ€¦  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


# ãŠã‚ã‚Šã«