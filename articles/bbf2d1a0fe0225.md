---
title: "いまさらNuxt3（その２）"
emoji: "⛰"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["nuxt3", "vue", "vuetify", "eslint", "vitest"]
published: false
publication_name: "robon"
---

# はじめに
１回目に続いて、Nuxt3 の入門記事です。

https://zenn.dev/robon/articles/2932b0bbb8d251

# 作ってみよう
## app.vue と layouts と pages と
ま、以下を参照してください。

https://nuxt.com/docs/guide/directory-structure/app

https://nuxt.com/docs/guide/directory-structure/layouts

https://nuxt.com/docs/guide/directory-structure/pages

で、app.vue。ま、main というかエントリポイントになってます。

```html:app.vue
<template>
  <NuxtLayout>
    <NuxtPage />
  </NuxtLayout>
</template>
```

これで、layouts を使うよ。とか、ルーティングで pages から刺してね。みたいな

layouts を使うと、（付け替えもできるけど）全部に被さるので、Vuetify のお約束の v-app に入れといてね❤を強制できます。今回は、Vuetify 感を出すために、v-app-bar を少しモリましたが、一か所で共通レイアウトとかコンポーネントとか実現できていい感じです。

```html:layouts/default.vue
<template>
  <v-app>
    <v-app-bar>
      <template #prepend>
        <v-app-bar-nav-icon />
      </template>
      <v-app-bar-title>Title</v-app-bar-title>
      <template #append>
        <v-btn icon="mdi-dots-vertical" />
      </template>
    </v-app-bar>
    <v-main>
      <slot />
    </v-main>
  </v-app>
</template>
```

そして、pages も折角なんで、Vuetify の Grid と Style を使ったものにしました。

```html:pages/index.vue
<template>
  <v-container>
    <v-row>
      <v-spacer />
      <v-col
        align="center"
        class="text-h1"
      >
        Top Page
      </v-col>
      <v-spacer />
    </v-row>
  </v-container>
</template>
```

で、pnpm dev して、動かして、ブラウザ上の Nuxt DevTools で見ると構造が見えて、頭の中も整理できるかもしれません。

![](/images/bbf2d1a0fe0225/TopPage.png)

## お題
さて、お題です。RESTful な WebAPI のバックエンドに対するフロントエンドを作ろうというものです。このブログでは、かつて RESTful な API を作ろうシリーズをやってまして、そのお題と同じものをバックエンドとして想定したいと思います。

https://zenn.dev/robon/articles/76d4ec767b72ae

まず、Nuxt の中を流れるデータ型を定義します。Nuxt3 では、オートインポートの対象にならないのですが、shared/types に作ります。

https://nuxt.com/docs/guide/directory-structure/shared

```ts:shared/types/customer.ts
export interface Customer {
  customerId: number
  name?: string
  address?: string
}
```

```ts:shared/types/orderHeader.ts
export interface OrderHeader {
  orderId: number
  customerId?: number
  orderDate?: string
  orderDetail?: OrderDetail[]
}

export interface OrderDetail {
  rowNum: number
  productId?: number
  quantity?: number
  pricePerUnit?: number
}
```

```ts:shared/types/product.ts
export interface Product {
  productId: number
  name?: string
  pricePerUnit?: number
}
```

で、これらの NestJS が自動生成するところの create、findAll、findOne、update、remove を作っていきます。

### create
```html:/pages/customer/new.vue
<script setup lang="ts">
import type { Customer } from '~/shared/types/customer'

const customer = ref<Partial<Customer>>({})
const formRef = useTemplateRef('form')

const create = async () => {
  const validResult = await formRef.value?.validate()
  if (validResult?.valid) {
    console.log('validなのでサーバを呼びます!')
  }
}
</script>

<template>
  <v-form ref="form">
    <v-container>
      <v-row class="pt-6">
        <div class="text-subtitle-1">
          顧客マスタ
        </div>
      </v-row>
      <v-row class="py-2">
        <v-col
          cols="12"
          sm="6"
          md="4"
          ls="3"
        >
          <v-text-field
            v-model.number="customer.customerId"
            name="customerId"
            label="顧客ID"
            hint="顧客の識別子"
            type="number"
            :hide-spin-buttons="true"
            class="my-input-number"
            :rules="[(value) => (value ? true : '必須項目です')]"
          />
        </v-col>
        <v-col
          cols="12"
          sm="6"
          md="4"
          ls="3"
        >
          <v-text-field
            v-model="customer.name"
            name="name"
            label="氏名"
            hint="顧客の氏名"
            type="text"
          />
        </v-col>
        <v-col
          cols="12"
          sm="6"
          md="4"
          ls="3"
        >
          <v-text-field
            v-model="customer.address"
            name="address"
            label="住所"
            hint="顧客の住所"
            type="text"
          />
        </v-col>
      </v-row>
      <v-row class="py-2">
        <v-spacer />
        <v-col
          cols="12"
          sm="6"
          md="4"
          ls="3"
        >
          <v-btn
            block
            text="作成"
            color="primary"
            @click="create"
          />
        </v-col>
      </v-row>
    </v-container>
  </v-form>
</template>

<style scoped>
.my-input-number :deep(input) {
  text-align: end
}
</style>
```

# おわりに
