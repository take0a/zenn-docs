---
title: "VSCode拡張開発メモ"
emoji: "📘"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["vscode", "typescript"]
published: false
publication_name: "robon"
---
# はじめに
「[VSCodeでSQLMesh](https://zenn.dev/robon/articles/2cca1898b60468)」で、SQLMesh の VSCode 拡張を確認して、ソースコードもあるし、拡張を拡張しちゃうぞ。と思ったのですが、ソースコードの気持ちが全くわからず…。ということで、ネットにたくさんある VSCode 拡張の作り方の Yet Another なんとかですが、できるだけ最新の公式から。

# [概要](https://code.visualstudio.com/api)
## 拡張機能でできること(の例)
- VS Code の外観を色やファイルアイコンのテーマで変更する - Theming
- UI にカスタム コンポーネントとビューを追加する -ワークベンチの拡張
- HTML/CSS/JS で構築されたカスタム Web ページを表示する Webview を作成する - Webview ガイド
- 新しいプログラミング言語のサポート -言語拡張の概要
- 特定のランタイムのデバッグをサポートする -デバッガー拡張ガイド

# [拡張機能の概要](https://code.visualstudio.com/api/extension-capabilities/overview)
## [共通機能](https://code.visualstudio.com/api/extension-capabilities/common-capabilities)（の例）
- コマンド、構成、キーバインド、またはコンテキスト メニュー項目を登録します。
    - `vscode.commands` APIを使用してコマンドを登録および実行します。
    - `contributes.commands` コントリビューション ポイントを使用して、コマンド パレットでコマンドを使用できるようにします。
    - `contributes.configuration` コントリビューション ポイント を使用して拡張機能固有の設定を提供します。
    - `workspace.getConfiguration` API を使用してそれらを読み取ることができます。
    - カスタムキーバインドを追加できます。詳しくは、`contributes.keybindings` と[キーバインド](https://code.visualstudio.com/docs/getstarted/keybindings)のトピックをご覧ください。
    - 右クリックすると表示されるカスタムコンテキストメニュー項目を登録できます。詳しくは、`contributes.menus` コントリビューション ポイント をご覧ください。
- ワークスペースまたはグローバル データの保存。
    - `ExtensionContext.workspaceState`: キーと値のペアを書き込むことができるワークスペースストレージ。VS Code がこのストレージを管理し、同じワークスペースを再度開いたときに復元します。
    - `ExtensionContext.globalState`: キー/値のペアを書き込めるグローバルストレージです。VS Code はこのストレージを管理し、拡張機能のアクティベーションごとに復元します。`globalState` の `setKeysForSync` メソッド のを使って同期対象のキーを設定することで、グローバルストレージ内のキー/値のペアを選択的に同期できます。
    - `ExtensionContext.storageUri`: 拡張機能が読み取り/書き込み権限を持つローカルディレクトリを指す、ワークスペース固有のストレージURI。現在のワークスペースからのみアクセス可能な大きなファイルを保存する必要がある場合に適しています。
    - `ExtensionContext.globalStorageUri`: 拡張機能が読み取り/書き込み権限を持つローカルディレクトリを指すグローバルストレージURI。これは、すべてのワークスペースからアクセスできる大きなファイルを保存する必要がある場合に適したオプションです。
    - `ExtensionContext.secrets`: シークレット（または機密情報）を暗号化して保存するグローバルストレージ。これらの情報はマシン間で同期されません。VS Codeデスクトップ版では、Electron の [safeStorage API](https://www.electronjs.org/docs/latest/api/safe-storage) を活用します。VS Code for the Webでは、Double Key Encryption（DKE）実装を使用します。
- 通知メッセージを表示します。
- クイックピックを使用してユーザー入力を収集します。
- システム ファイル ピッカーを開いて、ユーザーがファイルまたはフォルダーを選択できるようにします。
- 長時間実行される操作を示すには、Progress API を使用します。

## テーマ設定（の例）
- ソースコードの色を変更します。
- VS Code UI の色を変更します。
- 既存の TextMate テーマを VS Code に移植します。
- カスタム ファイル アイコンを追加します。

## 宣言型言語機能（の例）
- 一般的な JavaScript スニペットを拡張機能にバンドルします。
- VS Code に新しいプログラミング言語について伝えます。
- プログラミング言語の文法を追加または置き換えます。
- 文法注入を使用して既存の文法を拡張します。
- 既存の TextMate 文法を VS Code に移植します。

## プログラム言語機能（の例）
- API の使用例を表示するホバーを追加します。
- 診断を使用して、ソース コード内のスペルまたはリンター エラーを報告します。
- HTML 用の新しいコード フォーマッタを登録します。
- 豊富でコンテキストに応じた IntelliSense を提供します。
- 言語に折りたたみ、パンくずリスト、アウトラインのサポートを追加します。

## ワークベンチ拡張機能（の例）
- ファイル エクスプローラーにカスタム コンテキスト メニュー アクションを追加します。
- サイド バーに新しいインタラクティブな TreeView を作成します。
- 新しいアクティビティ バー ビューを定義します。
- ステータス バーに新しい情報を表示します。
- WebView APIを使用してカスタム コンテンツをレンダリングします。
- ソース管理プロバイダーに貢献します。

## デバッグ（の例）
- デバッグ アダプターの実装を提供することで、VS Code のデバッグ UI をデバッガーまたはランタイムに接続します。
- デバッガー拡張機能でサポートされる言語を指定します。
- デバッガーによって使用されるデバッグ構成属性に関する豊富な IntelliSense とホバー情報を提供します。
- デバッグ構成スニペットを提供します。

- 動的に作成されたデバッグ構成に基づいてデバッグ セッションを開始します。
- デバッグ セッションのライフサイクルを追跡します。
- プログラムでブレークポイントを作成および管理します。

## 制限
- 拡張機能はVS Code UIのDOMにアクセスできません。
- ユーザーまたは拡張機能によって提供されるカスタム スタイル シートは、DOM 構造とクラス名に対して機能します。

# 